<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>Will you be my Valentine?üíï</title>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        :root{
            --primary-pink:#ff69b4;
            --secondary-pink:#ffb6c1;
            --dark-pink:#ff1493;
            --bg-gradient: linear-gradient(135deg,#ffeef8 0%,#ffe0f0 100%);
            --safe-area-top: env(safe-area-inset-top, 0px);
            --safe-area-bottom: env(safe-area-inset-bottom, 0px);
        }

        body{
            font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;
            background:var(--bg-gradient);
            min-height:100vh;
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            padding: calc(26px + var(--safe-area-top)) 18px calc(26px + var(--safe-area-bottom)) 18px;
            overflow-x:hidden;
            position:relative;
        }

        /* Floating hearts background */
        .floating-hearts{
            position:fixed; inset:0;
            pointer-events:none;
            z-index:0; overflow:hidden;
        }
        .heart-bg{
            position:absolute;
            font-size:20px;
            opacity:0.15;
            animation: float-up 15s infinite ease-in-out;
        }
        @keyframes float-up{
            0%{ transform:translateY(100vh) rotate(0deg); opacity:0; }
            10%{ opacity:0.15; }
            90%{ opacity:0.15; }
            100%{ transform:translateY(-100px) rotate(360deg); opacity:0; }
        }

        /* Main container */
        .container{
            max-width: 560px;
            width:100%;
            text-align:center;
            position:relative;
            z-index:1;
            animation: fadeIn 0.8s ease-out;
        }
        @keyframes fadeIn{ from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }

        h1{
            font-size: clamp(34px, 8.5vw, 52px);
            line-height: 1.1;
            color: var(--dark-pink);
            margin-bottom: 22px;
            text-shadow: 2px 2px 4px rgba(255,105,180,0.2);
            animation: heartbeat 1.5s ease-in-out infinite;
            padding: 0 6px;
        }
        @keyframes heartbeat{
            0%,100%{transform:scale(1);}
            10%,30%{transform:scale(1.05);}
            20%,40%{transform:scale(1);}
        }

        .photo-container{
            width:100%;
            max-width: 420px;
            margin: 0 auto 18px;
            position:relative;
            border-radius: 24px;
            overflow:hidden;
            box-shadow: 0 14px 46px rgba(255,105,180,0.32);
            transition: transform 0.25s ease;
        }
        .photo-container img{
            width:100%;
            height:auto;
            display:block;
        }
        .photo-container:active{
            transform: scale(0.99);
        }

        .message{
            font-size: clamp(18px, 4.8vw, 24px);
            color: var(--dark-pink);
            margin: 12px 0 26px;
            min-height: 36px;
            font-weight: 650;
            letter-spacing: 0.2px;
            padding: 0 10px;
            transition: all 0.3s ease;
        }
        .message.shake{ animation: shake 0.5s ease; }
        @keyframes shake{
            0%,100%{transform:translateX(0);}
            25%{transform:translateX(-10px);}
            75%{transform:translateX(10px);}
        }

        .buttons-container{
            display:flex;
            gap: 16px;
            justify-content:center;
            align-items:center;
            flex-wrap:wrap;
            position:relative;
            min-height: 150px;
            margin-bottom: 16px;
            padding-bottom: 6px;
        }

        .btn{
            font-size: clamp(20px, 5.2vw, 28px);
            font-weight: 800;
            padding: 18px 44px;
            border:none;
            border-radius: 999px;
            cursor:pointer;
            transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
            box-shadow: 0 10px 28px rgba(0,0,0,0.12);
            min-width: 150px;
            min-height: 58px; /* Œ∫Œ±ŒªœçœÑŒµœÅŒø tap target */
            touch-action: manipulation;
            user-select:none;
        }

        .btn-yes{
            background: linear-gradient(135deg, var(--primary-pink), var(--dark-pink));
            color:white;
            animation: pulse 2s ease-in-out infinite;
            position:relative;
            overflow:visible;
        }
        @keyframes pulse{
            0%,100%{ transform:scale(1); box-shadow:0 10px 28px rgba(255,20,147,0.28);}
            50%{ transform:scale(1.05); box-shadow:0 14px 36px rgba(255,20,147,0.42);}
        }
        .btn-yes:active{ transform: scale(0.96); }

        /* IMPORTANT: start as relative, go absolute after first No click (JS) */
        .btn-no{
            background:white;
            color: var(--dark-pink);
            border: 3px solid var(--secondary-pink);
            position:relative;
            transition: transform 0.18s ease, background 0.18s ease, border-color 0.18s ease, left 0s, top 0s;
            box-shadow: 0 10px 28px rgba(0,0,0,0.08);
        }
        .btn-no:active{ transform: scale(0.96); }

        .sparkle{
            position:fixed;
            pointer-events:none;
            font-size:22px;
            z-index:1000;
            animation: sparkle-float 1s ease-out forwards;
        }
        @keyframes sparkle-float{
            0%{ opacity:1; transform: translateY(0) scale(0); }
            50%{ transform: translateY(-30px) scale(1); }
            100%{ opacity:0; transform: translateY(-60px) scale(0.5); }
        }

        .audio-controls{
            position: fixed;
            top: calc(14px + var(--safe-area-top));
            right: 14px;
            z-index: 100;
        }

        .audio-btn{
            background: white;
            border: 3px solid var(--secondary-pink);
            border-radius: 999px;
            width: 78px;
            height: 78px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 34px;
            box-shadow: 0 14px 32px rgba(0,0,0,0.18);
            transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
            touch-action: manipulation;
        }

        .audio-btn:active{ transform: scale(0.94); }

        .audio-btn.is-on{
            box-shadow: 0 16px 36px rgba(255,20,147,0.26);
            border-color: var(--dark-pink);
        }

        /* ŒºŒπŒ∫œÅœå ‚Äúbadge‚Äù Œ≥ŒπŒ± ŒΩŒ± Œ∫Œ±œÑŒ±ŒªŒ±Œ≤Œ±ŒØŒΩŒµŒπ œÑŒπ ŒΩŒ± Œ∫Œ¨ŒΩŒµŒπ */
        .audio-hint{
            position: fixed;
            top: calc(98px + var(--safe-area-top));
            right: 14px;
            z-index: 100;
            background: rgba(255,255,255,0.9);
            border: 2px solid var(--secondary-pink);
            color: var(--dark-pink);
            padding: 10px 12px;
            border-radius: 14px;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 10px 22px rgba(0,0,0,0.12);
            max-width: 180px;
        }
        .audio-hint.hidden{ display:none; }

        .celebration-overlay{
            position:fixed; inset:0;
            background: rgba(255,255,255,0.95);
            display:none;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            z-index:1000;
            animation: fadeIn 0.5s ease;
            padding: 20px;
        }
        .celebration-overlay.active{ display:flex; }
        .celebration-message{
            font-size: clamp(34px, 9vw, 62px);
            color: var(--dark-pink);
            margin-bottom: 18px;
            animation: bounceIn 0.8s ease;
            text-align:center;
            padding: 0 10px;
        }
        @keyframes bounceIn{
            0%{ transform:scale(0); opacity:0;}
            50%{ transform:scale(1.2);}
            100%{ transform:scale(1); opacity:1;}
        }

        #confettiCanvas{
            position:fixed; inset:0;
            width:100%;
            height:100%;
            pointer-events:none;
            z-index:999;
        }

        /* ============================= */
        /* MOBILE FIRST BOOST (IMPORTANT) */
        /* ============================= */

        @media (max-width: 600px){

            body{
                padding: calc(18px + var(--safe-area-top)) 14px
                calc(22px + var(--safe-area-bottom)) 14px;
            }

            .container{
                max-width: 100%;
            }

            h1{
                font-size: 42px;
                margin-bottom: 18px;
            }

            .photo-container{
                max-width: 100%;
                border-radius: 26px;
                margin-bottom: 18px;
            }

            .message{
                font-size: 22px;
                margin-bottom: 22px;
                min-height: 44px;
            }

            .buttons-container{
                flex-direction: column;
                gap: 18px;
                min-height: auto;
            }

            .btn{
                width: 100%;
                max-width: 360px;
                font-size: 26px;
                padding: 20px 0;
                min-height: 68px;
            }

            .btn-no{
                position: relative !important;
                left: auto !important;
                top: auto !important;
                transform: none !important;
            }

            .audio-btn{
                width: 82px;
                height: 82px;
                font-size: 38px;
            }

            .celebration-message{
                font-size: 52px;
            }
        }

    </style>
</head>

<body>
<div class="floating-hearts" id="floatingHearts"></div>

<div class="audio-controls">
    <button class="audio-btn" id="audioBtn" aria-label="Start music">üéµ</button>
</div>
<div class="audio-hint" id="audioHint">Œ†ŒµœÅŒØŒºŒµŒΩŒµ! Œ†Œ¨œÑŒ± œÄœÅœéœÑŒ± ŒµŒ¥œé! üé∂</div>

<div class="container">
    <h1>Will you be my Valentine? üíï</h1>

    <div class="photo-container" id="photoContainer">
        <img id="mainPhoto"
             src="assets/zentangle.jpg"
             alt="Valentine photo"
             onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22400%22%3E%3Crect fill=%22%23ffe0f0%22 width=%22400%22 height=%22400%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Arial%22 font-size=%2260%22 fill=%22%23ff69b4%22%3E%E2%9D%A4%EF%B8%8F%3C/text%3E%3Ctext x=%2250%25%22 y=%2265%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Arial%22 font-size=%2220%22 fill=%22%23ff1493%22%3EAdd assets/main-image.jpg%3C/text%3E%3C/svg%3E'">
    </div>

    <div class="message" id="message"></div>

    <div class="buttons-container" id="buttonsContainer">
        <button class="btn btn-yes" id="yesBtn">Yes! üíñ</button>
        <button class="btn btn-no" id="noBtn">No</button>
    </div>
</div>

<div class="celebration-overlay" id="celebrationOverlay">
    <div class="celebration-message" id="celebrationMessage">Yay! üíï‚ú®</div>
    <div class="photo-container">
        <img id="celebrationPhoto"
             src="assets/final-image.jpg"
             alt="Celebration photo"
             onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22400%22%3E%3Crect fill=%22%23ffe0f0%22 width=%22400%22 height=%22400%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Arial%22 font-size=%2260%22 fill=%22%23ff1493%22%3E%F0%9F%8E%89%3C/text%3E%3Ctext x=%2250%25%22 y=%2265%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Arial%22 font-size=%2220%22 fill=%22%23ff1493%22%3EAdd assets/final-image.jpg%3C/text%3E%3C/svg%3E'">
    </div>
</div>

<canvas id="confettiCanvas"></canvas>

<audio id="bgMusic" loop preload="auto">
    <source src="assets/valentine.mp3" type="audio/mpeg" />
</audio>

<script>
    const CONFIG = {
        noMessages: [
            "Œ£ŒØŒ≥ŒøœÖœÅŒ±; ü•∫",
            "ŒúŒÆœÄœâœÇ ŒΩŒ± œÑŒø ŒæŒ±ŒΩŒ±œÉŒ∫ŒµœÜœÑŒµŒØœÇ; üí≠",
            "Œ†ŒªŒπŒπŒπŒπŒ∂; üôè",
            "Œ†Œ¨œÑŒ± Yes Œ±ŒΩ ŒµŒØœÉŒ±Œπ Œ†ŒëŒü! ‚ú®",
            "ŒîŒµŒΩ Œ∏Œ± œÑŒø ŒºŒµœÑŒ±ŒΩŒπœéœÉŒµŒπœÇ! üíï",
            "Seriously? üò¢",
            "Okay fine... Œ±ŒªŒªŒ¨ Œ∫ŒøŒØœÑŒ± œÄœåœÉŒø ŒºŒπŒ∫œÅœå Œ≠Œ≥ŒπŒΩŒµ! üîç",
            "Œ§ŒµŒªŒµœÖœÑŒ±ŒØŒ± œÄœÅŒøŒµŒπŒ¥ŒøœÄŒøŒØŒ∑œÉŒ∑! ‚ö†Ô∏è",
            "Fine... ŒüŒö Œ¥ŒµœÇ œÑŒπ Œ∏Œ± Œ≥ŒØŒΩŒµŒπ œÑœéœÅŒ±! üòè"
        ],
        finalNoMessage: "ŒëœÜŒøœç ŒµœÄŒπŒºŒ≠ŒΩŒµŒπœÇ... œÑŒø Œ∫ŒøœÖŒºœÄŒØ No Œ∏Œ± Œ≥ŒØŒΩŒµŒπ YES! üòà",
        celebrationMessage: "Yay! Best Valentine Ever! üíï‚ú®üéâ",

        noButtonShrinkFactor: 0.82,
        noButtonMinScale: 0.25,
        maxNoClicks: 10,

        enableHoverDodge: true,
        hoverDodgeDistance: 80
    };

    let noClickCount = 0;
    let audioEnabled = false;
    let noButtonScale = 1;
    let isNoButtonTrapped = false;

    const yesBtn = document.getElementById('yesBtn');
    const noBtn = document.getElementById('noBtn');
    const message = document.getElementById('message');
    const celebrationOverlay = document.getElementById('celebrationOverlay');
    const celebrationMessage = document.getElementById('celebrationMessage');
    const audioBtn = document.getElementById('audioBtn');
    const audioHint = document.getElementById('audioHint');
    const bgMusic = document.getElementById('bgMusic');
    const buttonsContainer = document.getElementById('buttonsContainer');
    const confettiCanvas = document.getElementById('confettiCanvas');
    const ctx = confettiCanvas.getContext('2d');

    // ---- AUDIO: one-tap start (mobile-friendly) ----
    async function startMusic() {
        if (audioEnabled) return;

        const sourceEl = bgMusic.querySelector('source');
        const src = sourceEl && sourceEl.getAttribute('src');
        if (!src) {
            console.log('No audio source set.');
            return;
        }

        try {
            // Œ¶ŒøœÅœÑœéŒΩŒøœÖŒºŒµ ŒΩœâœÅŒØœÇ, Œ∫Œ±Œπ Œ∫Œ¨ŒΩŒøœÖŒºŒµ play œÉŒµ gesture-valid event (pointerdown/touchstart).
            bgMusic.load();

            // iOS-friendly: start muted, then unmute
            bgMusic.muted = true;

            // ŒúŒπŒ∫œÅœå "Œ¥ŒπœÄŒªœå attempt" ŒºŒ≠œÉŒ± œÉœÑŒø ŒôŒîŒôŒü gesture Œ≥ŒπŒ± browsers œÄŒøœÖ Œ∫ŒøŒªŒªŒ¨ŒΩŒµ œÉœÑŒø œÄœÅœéœÑŒø
            await bgMusic.play();
            bgMusic.muted = false;

            audioEnabled = true;
            audioBtn.textContent = 'üîä';
            audioBtn.classList.add('is-on');
            audioHint.classList.add('hidden');
        } catch (e) {
            // Œ∫œÅŒ±œÑŒ¨ŒºŒµ audioEnabled=false Œ≥ŒπŒ± ŒΩŒ± ŒæŒ±ŒΩŒ±Œ¥ŒøŒ∫ŒπŒºŒ¨œÉŒµŒπ œÉœÑŒø ŒµœÄœåŒºŒµŒΩŒø tap
            audioEnabled = false;
            audioBtn.textContent = 'üéµ';
            audioBtn.classList.remove('is-on');
            console.log('Audio play failed:', e);
        }
    }

    // ---- INIT ----
    function init() {
        createFloatingHearts();
        setupCanvas();
        setupEventListeners();
        positionNoButtonInitial();

        // Œ§Œø Œ†ŒôŒü œÉŒ∑ŒºŒ±ŒΩœÑŒπŒ∫œå: œÄœÅœéœÑŒøœÇ ‚Äútouch/pointerdown‚Äù ŒøœÄŒøœÖŒ¥ŒÆœÄŒøœÑŒµ -> startMusic
        // (Œ±œÖœÑœå œÄœÅŒ±Œ∫œÑŒπŒ∫Œ¨ ŒµŒæŒ±œÜŒ±ŒΩŒØŒ∂ŒµŒπ œÑŒø ‚ÄúŒ∏Œ≠ŒªŒµŒπ Œ¥ŒµœçœÑŒµœÅŒø tap‚Äù)
        document.addEventListener('pointerdown', startMusic, { once: true });
        document.addEventListener('touchstart', startMusic, { once: true, passive: true });
    }

    function createFloatingHearts() {
        const heartsContainer = document.getElementById('floatingHearts');
        const heartCount = 15;
        for (let i = 0; i < heartCount; i++) {
            const heart = document.createElement('div');
            heart.className = 'heart-bg';
            heart.textContent = 'üíï';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.animationDelay = Math.random() * 15 + 's';
            heart.style.fontSize = (Math.random() * 20 + 15) + 'px';
            heartsContainer.appendChild(heart);
        }
    }

    function setupEventListeners() {
        yesBtn.addEventListener('click', handleYesClick);
        noBtn.addEventListener('click', handleNoClick);

        // ŒìŒπŒ± audio: pointerdown (œÄŒπŒø Œ±ŒæŒπœåœÄŒπœÉœÑŒø œÉŒµ iOS Œ±œÄœå click)
        audioBtn.addEventListener('pointerdown', (e) => {
            e.preventDefault();
            startMusic();
        }, { passive: false });

        // Hover dodge desktop
        if (CONFIG.enableHoverDodge) {
            document.addEventListener('mousemove', handleMouseMove);
        }

        // Sparkles on Yes hover (desktop)
        yesBtn.addEventListener('mouseenter', () => createSparkle());
        yesBtn.addEventListener('mousemove', (e) => {
            if (Math.random() < 0.2) createSparkle(e.clientX, e.clientY);
        });
    }

    function createSparkle(x, y) {
        const sparkles = ['‚ú®', 'üíñ', 'üíï', '‚≠ê'];
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.textContent = sparkles[Math.floor(Math.random() * sparkles.length)];

        if (typeof x === 'number' && typeof y === 'number') {
            sparkle.style.left = (x + (Math.random() - 0.5) * 40) + 'px';
            sparkle.style.top  = (y + (Math.random() - 0.5) * 40) + 'px';
        } else {
            const rect = yesBtn.getBoundingClientRect();
            sparkle.style.left = (rect.left + rect.width / 2 + (Math.random() - 0.5) * rect.width) + 'px';
            sparkle.style.top  = (rect.top + rect.height / 2 + (Math.random() - 0.5) * rect.height) + 'px';
        }

        document.body.appendChild(sparkle);
        setTimeout(() => sparkle.remove(), 1000);
    }

    function handleMouseMove(e) {
        if (isNoButtonTrapped || noClickCount === 0) return;
        const r = noBtn.getBoundingClientRect();
        const cx = r.left + r.width / 2;
        const cy = r.top + r.height / 2;
        const distance = Math.hypot(e.clientX - cx, e.clientY - cy);
        if (distance < CONFIG.hoverDodgeDistance) {
            moveNoButtonAway(e.clientX, e.clientY);
        }
    }

    function handleYesClick() {
        celebrationMessage.textContent = CONFIG.celebrationMessage;
        celebrationOverlay.classList.add('active');
        createConfetti();

        // ŒëŒΩ Œ≥ŒπŒ± Œ∫Œ¨œÄŒøŒπŒø ŒªœåŒ≥Œø Œ¥ŒµŒΩ ŒæŒµŒ∫ŒØŒΩŒ∑œÉŒµ, ŒµŒ¥œé ŒæŒ±ŒΩŒ±œÄœÅŒøœÉœÄŒ±Œ∏ŒµŒØ
        if (!audioEnabled) startMusic();

        yesBtn.style.animation = 'none';
        setTimeout(() => { yesBtn.style.animation = 'pulse 2s ease-in-out infinite'; }, 10);
    }

    function handleNoClick(e) {
        e?.preventDefault();
        noClickCount++;

        if (noClickCount >= CONFIG.maxNoClicks) {
            trapNoButton();
            return;
        }

        const idx = Math.min(noClickCount - 1, CONFIG.noMessages.length - 1);
        message.textContent = CONFIG.noMessages[idx];
        message.classList.add('shake');
        setTimeout(() => message.classList.remove('shake'), 500);

        noButtonScale = Math.max(noButtonScale * CONFIG.noButtonShrinkFactor, CONFIG.noButtonMinScale);
        moveNoButton();

        const yesScale = 1 + (noClickCount * 0.08);
        yesBtn.style.transform = `scale(${Math.min(yesScale, 1.6)})`;

        yesBtn.style.animation = 'none';
        setTimeout(() => { yesBtn.style.animation = 'pulse 2s ease-in-out infinite'; }, 10);
    }

    function trapNoButton() {
        isNoButtonTrapped = true;

        message.textContent = CONFIG.finalNoMessage;
        message.style.color = '#ff1493';
        message.style.fontSize = '24px';
        message.style.fontWeight = 'bold';
        message.classList.add('shake');

        setTimeout(() => {
            noBtn.textContent = 'Yes! üíï';
            noBtn.style.background = 'linear-gradient(135deg, #ff69b4, #ff1493)';
            noBtn.style.color = 'white';
            noBtn.style.border = 'none';
            noBtn.style.transform = 'translate(-50%, -50%) scale(1.2)';
            noBtn.style.animation = 'pulse 1s ease-in-out infinite';

            noBtn.removeEventListener('click', handleNoClick);
            noBtn.addEventListener('click', handleYesClick);
        }, 1500);
    }

    function positionNoButtonInitial() {
        noBtn.style.position = 'relative';
        noBtn.style.left = 'auto';
        noBtn.style.top = 'auto';
        noBtn.style.transform = 'none';
    }

    function moveNoButton() {
        if (noClickCount === 1) {
            noBtn.style.position = 'absolute';
        }

        const container = buttonsContainer.getBoundingClientRect();
        const yesRect = yesBtn.getBoundingClientRect();

        let x, y, attempts = 0;
        const maxAttempts = 50;
        const minDistance = 130;

        do {
            x = Math.random() * (container.width - 120) + 60;
            y = Math.random() * (container.height - 120) + 60;

            const yesCX = (yesRect.left - container.left) + yesRect.width / 2;
            const yesCY = (yesRect.top  - container.top ) + yesRect.height / 2;

            const d = Math.hypot(x - yesCX, y - yesCY);
            if (d > minDistance) break;
            attempts++;
        } while (attempts < maxAttempts);

        noBtn.style.left = x + 'px';
        noBtn.style.top  = y + 'px';
        noBtn.style.transform = `translate(-50%, -50%) scale(${noButtonScale})`;
    }

    function moveNoButtonAway(mouseX, mouseY) {
        const container = buttonsContainer.getBoundingClientRect();
        const r = noBtn.getBoundingClientRect();
        const cx = r.left + r.width / 2;
        const cy = r.top + r.height / 2;

        const angle = Math.atan2(cy - mouseY, cx - mouseX);
        const moveDistance = 160;

        let newX = (r.left - container.left) + Math.cos(angle) * moveDistance;
        let newY = (r.top  - container.top ) + Math.sin(angle) * moveDistance;

        newX = Math.max(60, Math.min(container.width  - 60, newX));
        newY = Math.max(60, Math.min(container.height - 60, newY));

        noBtn.style.left = newX + 'px';
        noBtn.style.top  = newY + 'px';
        noBtn.style.transition = 'left 0.25s ease, top 0.25s ease';
    }

    function setupCanvas() {
        confettiCanvas.width = window.innerWidth;
        confettiCanvas.height = window.innerHeight;

        window.addEventListener('resize', () => {
            confettiCanvas.width = window.innerWidth;
            confettiCanvas.height = window.innerHeight;
        });
    }

    function createConfetti() {
        const shapes = ['‚ù§Ô∏è','üíï','üíñ','üíó','üíù','‚ú®','üéâ'];
        const particles = [];
        const particleCount = 160;

        for (let i = 0; i < particleCount; i++) {
            particles.push({
                x: Math.random() * confettiCanvas.width,
                y: -20 - Math.random() * 100,
                size: Math.random() * 26 + 16,
                speedY: Math.random() * 3 + 2,
                speedX: Math.random() * 6 - 3,
                rotation: Math.random() * 360,
                rotationSpeed: Math.random() * 15 - 7.5,
                shape: shapes[Math.floor(Math.random() * shapes.length)],
                opacity: 1
            });
        }

        function animate() {
            ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
            let active = 0;

            for (const p of particles) {
                if (p.y < confettiCanvas.height + 60 && p.opacity > 0) {
                    active++;

                    p.y += p.speedY;
                    p.x += p.speedX;
                    p.rotation += p.rotationSpeed;

                    if (p.y > confettiCanvas.height - 180) p.opacity -= 0.02;

                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate(p.rotation * Math.PI / 180);
                    ctx.globalAlpha = Math.max(0, p.opacity);
                    ctx.font = `${p.size}px Arial`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(p.shape, 0, 0);
                    ctx.restore();
                }
            }

            if (active > 0) requestAnimationFrame(animate);
            else ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
        }

        animate();
    }

    init();
</script>
</body>
</html>
